<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Contiv Networking on Baremetal or VMs">

    <link rel="shortcut icon" href="/assets/images/favicon.png">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <title>Contiv Network on Baremetal or VMs - Contiv</title>

    <link href="/assets/stylesheets/application-1f68e76e.css" rel="stylesheet"/>

    <!--[if lt IE 9]><script src="/assets/javascripts/html5shiv-099439cc.js"></script><script src="/assets/javascripts/respond.min-1eb35b04.js"></script><![endif]-->

    
  </head>

  <body id="page-Contiv Network on Baremetal or VMs" class=" page-Contiv Network on Baremetal or VMs layout-install page-sub">

<div id="header" class="navbar-static-top">
  <div class="container">
    <div class="row">
      
        <div class="navbar-header">
          <div class="navbar-brand">
              <img class="logo" src="/assets/images/logo-2407beb0.jpg">
              <a class="logo" href="/">Contiv</a>
            </a>
          </div>
          
        </div>
        <div class="buttons hidden-xs">
          <nav role="navigation">
            <ul class="main-links nav navbar-nav navbar-left">
              <li class="first li-under"><a href="/install/index.html">Documentation</a></li>
              <li class="li-under"><a href="/articles/index.html">Articles</a></li>
              <li class="li-under"><a href="https://github.com/contiv" target="_blank">
                        GitHub
                        <i class="fa fa-github fa-lg"></i>
                        </a></li>
                    <li class="li-under"><a href="https://contiv.slack.com" target="_blank">
                        Slack
                        <i class="fa fa-slack fa-lg"></i>
                        </a></li>
                    <li><a href="https://twitter.com/projectcontiv" target="_blank">
                        Twitter
                        <i class="fa fa-twitter fa-lg"></i>
                        </a></li>
            </ul>
          </nav>
        </div>
      
    </div>
  </div>
</div>


<div class="sidebar-overlay"></div>


<aside id="sidebar" class="sidebar sidebar-default sidebar-fixed-right" role="navigation">
    
    <div class="sidebar-header header-cover">
        
        <div class="sidebar-image">
            <img src="/assets/images/logo-header@2x.png" width="49px" height="56px">
        </div>
    </div>

    
    <ul class="main nav sidebar-nav">
        <li class="first"><a href="/intro/index.html">Intro</a></li>
        <li class=""><a href="/docs/index.html">Docs</a></li>
    </ul>
    <div class="divider"></div>
    
    <ul class="external nav sidebar-nav">
        <li class=""><a class="v-btn gray sml" href="https://github.com/contiv"><svg id="svg-download" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" style="enable-background:new 0 0 14 14;">
  <style>
  </style>
  <path class="" d="M13,0H1C0.5,0,0,0.5,0,1v12c0,0.5,0.5,1,1,1h4.7c0,0,0,0,0-0.1c0-0.2,0-0.6,0-1.1c-1.8,0.4-2.2-0.9-2.2-0.9
    c-0.3-0.8-0.7-1-0.7-1c-0.6-0.4,0-0.4,0-0.4c0.7,0,1,0.7,1,0.7c0.6,1,1.5,0.7,1.9,0.5c0.1-0.4,0.2-0.7,0.4-0.9c-1.5-0.2-3-0.7-3-3.2
    c0-0.7,0.3-1.3,0.7-1.8C3.7,5.8,3.5,5.1,3.9,4.2c0,0,0.6-0.2,1.8,0.7c0.5-0.1,1.1-0.2,1.6-0.2c0.6,0,1.1,0.1,1.6,0.2
    c1.3-0.8,1.8-0.7,1.8-0.7c0.4,0.9,0.1,1.6,0.1,1.7c0.4,0.5,0.7,1,0.7,1.8c0,2.5-1.5,3.1-3,3.2C8.7,11.1,9,11.5,9,12.1
    c0,0.9,0,1.6,0,1.8c0,0,0,0,0,0.1h4c0.5,0,1-0.5,1-1V1C14,0.5,13.5,0,13,0z"/>
</svg>
GitHub</a></li>
    </ul>
</aside>


<div class="container">
	<div class="row">
		<div class="col-md-3 col-sm-3 col-xs-12">
					<div class="docs-sidebar hidden-print affix-top" role="complementary">
			<hr>
			<h3>User Guide</h3>
			<ul class="nav docs-sidenav">
				<li class="active">
					<a data-toggle="collapse" href="#collapse100" href="/install/user_guides/getting_started/index.html">Getting Started</a>
				<div id="collapse100" class="panel-collapse collapse">

					<ul class="nav nav-visible">
						<li>
							<a href="/install/user_guides/getting_started/community_talks/index.html">Talks and Demonstrations</a>
						</li>
						<li>
							<a data-toggle="collapse" href="#collapse110" href="/install/user_guides/getting_started/networking/index.html">Networking</a>
									<div id="collapse110" class="panel-collapse collapse">
										<ul class="nav nav-visible">
											<li class="active">
													<a href="/install/user_guides/getting_started/networking/vagrant.html"> Development Setup with Vagrant</a>
											</li>
											<li>
													<a href="/install/user_guides/getting_started/networking/mcast.html">Multicast Demonstration</a>
											</li>
											<li>
													<a href="/install/user_guides/getting_started/networking/basic_server_setup.html">Basic Server Setup</a>
											</li>
											<li>
													<a href="/install/user_guides/getting_started/networking/swarm.html">Docker Swarm</a>
											</li>
											<li>
													<a href="/install/user_guides/getting_started/networking/k8s.html">Kubernetes</a>
											</li>
											<li>
													<a href="/install/user_guides/getting_started/networking/mesos.html">Mesos</a>
											</li>
											<li>
													<a href="/install/user_guides/getting_started/networking/nomad.html">Nomad</a>
											</li>
											<li>
													<a href="/install/user_guides/getting_started/networking/bgp.html">BGP</a>
											</li>
										</ul>
									</div>

						</li>
						<li>
							<a data-toggle="collapse" href="#collapse120" href="/install/user_guides/getting_started/network_topologies/index.html">Network Topologies</a>
							<div id="collapse120" class="panel-collapse collapse">
								<ul class="nav nav-visible">
									<li>
										<a href="/install/user_guides/getting_started/network_topologies/native_routed.html">Native Routing</a>
									</li>
									<li>
										<a href="/install/user_guides/getting_started/network_topologies/native_bridged.html">Native Bridging</a>
									</li>
									<li>
										<a href="/install/user_guides/getting_started/network_topologies/openstack.html">Openstack Deployment</a>
									</li>
									<li>
										<a href="/install/user_guides/getting_started/network_topologies/cloud.html">Cloud Deployment</a>
									</li>
									<li>
										<a href="/install/user_guides/getting_started/network_topologies/vagrant.html">Vagrant Setup</a>
									</li>
									<li>
										<a href="/install/user_guides/getting_started/network_topologies/networking101.html">Containers Networking Tutorial</a>
									</li>
									<li>
										<a href="/install/user_guides/getting_started/network_topologies/bgp.html">BGP</a>
									</li>
								</ul>
							</div>
						</li>
						<li>
							<a data-toggle="collapse" href="#collapse130" href="/install/user_guides/getting_started/storage/index.html">Storage </a>
							<div id="collapse130" class="panel-collapse collapse">
								<ul class="nav">
									<li><a href="/install/user_guides/getting_started/storage/swarm.html">Docker Swarm</a></li>
								</ul>
							</div>
						</li>
						<li>
							<a data-toggle="collapse" href="#collapse140" href="/install/user_guides/getting_started/storage_systems/index.html">Storage Systems</a>
							<div id="collapse140" class="panel-collapse collapse">
								<ul class="nav">
									<li><a href="/install/user_guides/getting_started/storage_systems/ceph.html">Ceph</a></li>
									<li><a href="/install/user_guides/getting_started/storage_systems/nfs.html">NFS</a></li>
								</ul>
							</div>
						</li>
					</ul>
				</div>
				</li>
				<li><a data-toggle="collapse" href="#collapse200" href="/install/user_guides/networking/index.html">Networking</a>
					<div id="collapse200" class="panel-collapse collapse">
						<ul class="nav nav-visible">
							<li><a href="/install/user_guides/networking/concepts.html">Terminology</a></li>
							<li><a href="/install/user_guides/networking/networks.html">Networks</a></li>
							<li><a href="/install/user_guides/networking/tenants.html">Tenants</a></li>
							<li><a href="/install/user_guides/networking/policies.html">Policies</a></li>
							<li><a href="/install/user_guides/networking/external_connectivity.html">External Connectivity</a></li>
							<li><a href="/install/user_guides/networking/service_discovery.html">Service Discovery</a></li>
							<li><a href="/install/user_guides/networking/ipam.html">IP Address Management</a></li>
							<li> <a href="/install/user_guides/networking/hybrid_workloads.html">Hybrid Workloads</a></li>
						</ul>
					</div>
				</li>
				<li><a data-toggle="collapse" href="#collapse300" href="/install/user_guides/storage/index.html">Storage</a>
					<div id="collapse300" class="panel-collapse collapse">
						<ul class="nav nav-visible">
							<li><a href="/install/user_guides/storage/concepts.html">Terminology</a></li>
							<li><a data-toggle="collapse" href="#collapse320" href="/install/user_guides/storage/policies/index.html">Policies</a></li>
								<div id="collapse320" class="panel-collapse collapse">
									<ul class="nav nav-visible">
										<li>
											<a href="/install/user_guides/storage/policies/allocation.html">Allocation</a></li>
										<li>
											<a href="/install/user_guides/storage/policies/rate_limiting.html">IOPs Rate Limiting</a></li>
										<li>
											<a href="/install/user_guides/storage/policies/snapshots.html">Snapshots</a></li>
										<li>
											<a href="/install/user_guides/storage/policies/filesystem.html">FileSystem</a></li>
									</ul>
								</div>
							<li><a href="/install/user_guides/storage/ceph.html">Ceph</a></li>
							<li><a href="/install/user_guides/storage/nfs.html">NFS</a></li>
							<li><a href="/install/user_guides/storage/disk_management.html">Disk Management</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a data-toggle="collapse" href="#collapse400" href="/install/user_guides/cluster/index.html">Cluster</a>
					<div id="collapse400" class="panel-collapse collapse">
						<ul class="nav nav-visible">
								<li><a href="/install/user_guides/cluster/concepts.html">Terminology</a></li>
								<li><a href="/install/user_guides/cluster/discovery.html">Discovery</a></li>
								<li><a href="/install/user_guides/cluster/commissioning.html">Commissioning and Decommissioning</a></li>
						</ul>
					</div>
				</li>
				<hr><p>
				<h3>Reference</h3>
					<ul class="nav nav-visible">
						<li><a href="https://godoc.org/github.com/contiv/netplugin">Network API Reference</a><br></li>
						<li><a href="https://godoc.org/github.com/contiv/contivmodel/client">Storage API Reference</a><br></li>
						<li><a href="https://godoc.org/github.com/contiv/cluster">Cluster API Reference</a><br></li>
					</ul>
				<hr><p>
				<h3>Examples</h3>
					<ul class="nav nav-visible">
						<li><a href="/install/samples/index.html">Example Use Cases</a><br></li>
					</ul>
				<hr><p>

				</li>
			</ul>
		</div>

		</div>  
		<div id="main-content" class="col-sm-9 col-md-9 col-xs-12" role="main">
			<div class="bs-docs-section">
				
	<h1>Creating a Development Environment with Vagrant</h1>
<p>This page describes how to quickly create a virtual environment
using the Vagrant environment setup tool. You then demonstrate 
some of the features of Docker and Contiv such as creating container,
networks, and policies.</p>

<h2>Prerequisites</h2>
<p>Before you can install the virtual environment, you must have the following 
software packages on your machine:</p>

<ul>
<li>VirtualBox 5.0.2 or later
</li>
<li>Vagrant 1.7.4
</li>
<li>Make
</li>
</ul>

<h2>Step 1: Start the Virtual Environment</h2>
<p>The following three commands are all you need to clone the repository and start the VMs:</p>
<pre class="highlight plaintext"><code>$ git clone https://github.com/contiv/netplugin
$ cd netplugin; make demo
$ vagrant ssh netplugin-node1
</code></pre>
<p>These commands start a cluster of two VMs running Docker and Contiv Network, and log
you into one of the VMs.</p>

<h2>Step 2: Create a Network</h2>
<p>Use the following command to create a network:</p>
<pre class="highlight plaintext"><code>netplugin-node1$ netctl net create contiv-net --subnet=20.1.1.0/24 --gateway=20.1.1.254 --pkt-tag=1001
</code></pre>

<h2>Step 2: Run Containers on Two Hosts</h2>
<p>Start a Docker container on the node you just logged into:</p>
<pre class="highlight plaintext"><code>netplugin-node1$ Docker run -itd --name=web --net=contiv-net ubuntu /bin/bash
</code></pre>
<p>In another shell window, log into the second VM and start another Docker container:</p>
<pre class="highlight plaintext"><code>$ vagrant ssh netplugin-node1
netplugin-node2$ docker run -itd --name=db --net=contiv-net ubuntu /bin/bash
</code></pre>
<p>On node1, log into the container and ping the container on node2:</p>
<pre class="highlight plaintext"><code>netplugin-node1$ docker exec -it web /bin/bash
&lt; inside the container &gt;
root@f90e7fd409c4:/# ping db
PING db (20.1.1.3) 56(84) bytes of data.
64 bytes from db (20.1.1.3): icmp_seq=1 ttl=64 time=0.658 ms
64 bytes from db (20.1.1.3): icmp_seq=2 ttl=64 time=0.103 ms
</code></pre>

<h2>Step 3: Create a Policy</h2>
<p>Type the following to create a policy named <code>prod_web</code>:</p>
<pre class="highlight plaintext"><code>$ netctl policy create prod_web
</code></pre>

<h2>Step 2: Add Rules to the Policy</h2>
<p>The following three commands add a default-deny rule to drop all incoming TCP 
connections and two rules to explicitly allow traffic on ports 80 and 443.</p>
<pre class="highlight plaintext"><code>$ netctl policy rule-add prod_web 1 -direction=in -protocol=tcp -action=deny
$ netctl policy rule-add prod_web 2 -direction=in -protocol=tcp -port=80 -action=allow -priority=10
$ netctl policy rule-add prod_web 3 -direction=in -protocol=tcp -port=443 -action=allow -priority=10
</code></pre>

<h2>Step 3: Create an Endpoint Group</h2>
<p>An endpoint group (EPG) is a collection of containers&#39; interfaces on a network. You create an endpoint
group, then assign nodes to it.</p>
<p>Use the following command to create an endpoint group named <code>web</code> in network <code>contiv-net</code> and attach the
<code>prod_web</code> policy to it.</p>
<pre class="highlight plaintext"><code>$ netctl group create contiv-net web -policy=prod_web
</code></pre>
<p><em>Note</em>: Every endpoint group creates a seperate Docker network of the form <code>&lt;endpoint-group-name&gt;.&lt;network-name&gt;</code>. 
You can attach containers to these endpoint groups using the <code>--net</code> option in the <code>docker run</code> command.</p>

<h2>Step 4: Attach a Container</h2>
<p>Next, run a container and attach it to the endpoint group.
The following command runs a Docker container and attaches it to the <code>web</code> EPG 
in the <code>contiv-net</code> network.</p>
<pre class="highlight plaintext"><code>$ docker run -itd --net web.contiv-net ubuntu bash
</code></pre>

<h2>Using Netplugin with Docker Swarm</h2>
<p>Docker Swarm is a scheduler that schedules containers to multiple hosts. Netplugin is a Docker network plugin that provides multi host networking.</p>
<p>Docker + Swarm + Netplugin == Awesome!!</p>

<h3>Using swarm</h3>
<p>Netplugin vagrant setup comes pre-installed with Docker swarm.
Set the following environment variable to make Docker client talk to Swarm
<code>
export DOCKER_HOST=tcp://192.168.2.10:2375
</code>
Now, you should be able to see the information about the swarm cluster
<code>
$ docker info
Containers: 0
Images: 5
Engine Version:
Role: primary
Strategy: spread
Filters: affinity, health, constraint, port, dependency
Nodes: 2
 netplugin-node1: 192.168.2.10:2385
  └ Containers: 0
  └ Reserved CPUs: 0 / 4
  └ Reserved Memory: 0 B / 2.051 GiB
  └ Labels: executiondriver=native-0.2, kernelversion=4.0.0-040000-generic, operatingsystem=Ubuntu 15.04, storagedriver=devicemapper
 netplugin-node2: 192.168.2.11:2385
  └ Containers: 0
  └ Reserved CPUs: 0 / 4
  └ Reserved Memory: 0 B / 2.051 GiB
  └ Labels: executiondriver=native-0.2, kernelversion=4.0.0-040000-generic, operatingsystem=Ubuntu 15.04, storagedriver=devicemapper
CPUs: 8
Total Memory: 4.103 GiB
Name: netplugin-node1
No Proxy: 192.168.0.0/16,localhost,127.0.0.0/8
</code></p>
<p>Next, you can see if there are any containers running in the cluster
```
$ docker ps
CONTAINER ID        IMAGE                          COMMAND             CREATED             STATUS              PORTS               NAMES
4dd09bc36875        ubuntu                         &quot;bash&quot;              52 minutes ago      Up 52 minutes                           netplugin-node1/reverent_allen
18bdc2cde778        skynetservices/skydns:latest   &quot;/skydns&quot;           3 hours ago         Up 3 hours          53/udp, 53/tcp      netplugin-node1/defaultdns</p>
<pre class="highlight plaintext"><code>
You can run containers and attach them to contiv networks or endpoint groups just like before.
</code></pre>
<p>$ docker run -itd --net web.contiv-net ubuntu bash
f291e269b45a5877f6fc952317feb329e12a99bda3a44a740b4c3307ef87954c
``<code>
Here,</code>docker run` happens against the swarm cluster. Swarm schedules the container to one of the nodes and netplugin on that node sets up the networking and policies just like before.</p>

<h2>Service discovery</h2>
<p>Contiv network provides built in service discovery for all containers in the network. Unlike traditional service discovery tools which require applications to query external KV stores for container IP/port information, contiv service discovery uses standard DNS protocol and requires no changes to the application.</p>
<p>When a container is attached to an endpoint group, it automatically becomes reachable by DNS service name. In the example above, we ran a container and attached it to <code>web</code> endpoint group. This container becomes available by DNS name <code>web</code> for all other containers in the same network. It would be available as <code>web.contiv-net</code> for all containers in other networks within the same tenant. If there are multiple containers in same endpoint group, all of them would be available by same DNS service name. DNS queries will be load balanced across all containers in the group.</p>

<h2>Multi tenancy</h2>

<h2>Using Netplugin on baremetal servers</h2>

<h2>Using Netplugin with Kubernetes</h2>

<h2>Working with Cisco ACI</h2>


			</div>
		</div>
	</div>
</div>